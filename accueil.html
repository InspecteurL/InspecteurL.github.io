<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Feuilleter</title>
    <link rel="icon" href="https://o.remove.bg/downloads/c77a350a-4165-43b8-9cc6-afe80fff5571/sticker-luffy-removebg-preview.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>
<body onload="generateOptions(); loadEpisode(0); updateProgressBar();">

    <!-- Bouton d'ouverture de la modale -->
    <button class="btn" id="myBtn">Essayer</button>

    <!-- Modale de lecture d'√©pisode -->
    <div id="episodePopup" class="modal">
        <div class="modal-content">
            <span class="close" id="closeBtn">&times;</span>
            <h1 id="episodeTitle">√âpisode 1</h1>
            <iframe id="videoPlayer" src="" allowfullscreen></iframe>
            <div class="controls">
                <button onclick="previousEpisode()">√âpisode pr√©c√©dent</button>
                <button onclick="nextEpisode()">√âpisode suivant</button>
                <select id="episodeSelector" onchange="loadEpisode(this.value)"></select>
            </div>
        </div>
    </div>

    <!-- Titre principal -->
    <h1 class="BigText">Berserk</h1>

    <!-- Barre de navigation -->
    <ul>
        <li><a class="active" href="index.html">Home</a></li>
        <li><a href="journal.html">Journal</a></li>
        <li><a href="profil.html">D√©couvrir</a></li>
        <li><a href="lecteurtest.html">Profil</a></li>
        <div class="searchbar" style="text-align: center; margin: 20px;">
    <input type="text" id="searchInput" placeholder="üîç Rechercher un anime..." style="padding:10px; width:300px; border-radius:10px;">
</div>
    </ul>

    <!-- Image de fond -->
    <div class="image-wrapper">
    <img id="berserkimage" src="fondberserk.jpg" alt="Berserk">
    <div class="gradient-overlay"></div>
  </div>


    <!-- Section des recommandations -->
    <section class="moviesection">
        <h2>Nos Recommandations Animes</h2>
        <hr class="rounded">
        <div class="moviecontainer" id="movies">
            <!-- Chaque bloc d'anime -->
            <div class="movieimg" data-title="Erased" data-genre="Seinen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="animera.html"><img id="erased" alt="Erased"></a>
    </div>
    <h2>Erased</h2>
    <span>Seinen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Steins ; Gate" data-genre="Seinen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="steinsgate.html"><img id="steinsgate" alt="Steins ; Gate"></a>
    </div>
    <h2>Steins ; Gate</h2>
    <span>Seinen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Call Of The Night" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="cotn.html"><img id="cotn" alt="Call Of The Night"></a>
    </div>
    <h2>Call Of The Night</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Cyberpunk Edgerunners" data-genre="Seinen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="cyber.html"><img id="cyberpunk" alt="Cyberpunk Edgerunners"></a>
    </div>
    <h2>Cyberpunk Edgerunners</h2>
    <span>Seinen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Platinum End" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="platinum.html"><img id="platinumend" alt="Platinum End"></a>
    </div>
    <h2>Platinum End</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Hell's Paradise" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="hell.html"><img id="hellsparadise" alt="Hell's Paradise"></a>
    </div>
    <h2>Hell's Paradise</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Chibi Revengers" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="chbireven.html"><img id="chibirevengers" alt="Chibi Revengers"></a>
    </div>
    <h2>Chibi Revengers</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Death Note" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="dnote.html"><img id="deathnote" alt="Death Note"></a>
    </div>
    <h2>Death Note</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Oshi no Ko" data-genre="Seinen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="oshinoko.html"><img id="oshinoko" alt="Oshi no Ko"></a>
    </div>
    <h2>Oshi no Ko</h2>
    <span>Seinen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Death Parade" data-genre="Seinen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="deathparade.html"><img id="deathparade" alt="Death Parade"></a>
    </div>
    <h2>Death Parade</h2>
    <span>Seinen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Blue Period" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="blueperiod.html"><img id="blueperiod" alt="Blue Period"></a>
    </div>
    <h2>Blue Period</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Steins ; Gate 0" data-genre="Seinen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="steinsgatezero.html"><img id="steinsgate0" alt="Steins ; Gate 0"></a>
    </div>
    <h2>Steins ; Gate 0</h2>
    <span>Seinen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Jujutsu Kaisen" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="jjk.html"><img id="jujutsukaisen" alt="Jujutsu Kaisen"></a>
    </div>
    <h2>Jujutsu Kaisen</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
<div class="movieimg" data-title="Dragon Ball" data-genre="Shonen">
    <div class="myimages">
        <span class="favorite-badge">‚≠ê</span>
        <a href="db.html"><img id="dragonball" alt="Dragon Ball"></a>
    </div>
    <h2>Dragon Ball</h2>
    <span>Shonen</span>
    <div class="rating-stars"></div>
</div>
        </div>
        
    </section>
<div style="text-align: center; margin: 30px;">
    <button onclick="exportAnimeData()">üì§ Exporter mes donn√©es</button>
</div>
<div style="text-align: center; margin: 10px;">
    <input type="file" id="importFile" accept=".json">
</div>


    <!-- Menu contextuel personnalis√© -->
    <div class="context-menu" id="context-menu">
        <div class="context-menu-item" onclick="handleFavorite()">‚≠ê Ajouter aux favoris</div>
<div class="context-menu-item" onclick="handleRating()">üìù Noter</div>
        <div class="context-menu-item" data-status="En cours">En cours</div>
        <div class="context-menu-item" data-status="Termin√©">Termin√©</div>
        <div class="context-menu-item" data-status="En Pause">En Pause</div>
        <div class="context-menu-item" data-status="Abandonn√©">Abandonn√©</div>
        <div class="context-menu-item" data-status="Envie de voir">Envie de voir</div>
    </div>

    <!-- Barre de progression -->
    <div style="width: 100%; background: #ccc; height: 20px; margin-top: 20px;">
        <div id="progress-bar" style="height: 100%; width: 0%; background: red;"></div>
    </div>



<div class="filters" style="text-align: center; margin: 20px;">
    <select id="genreFilter">
        <option value="">Tous les genres</option>
        <option value="Shonen">Shonen</option>
        <option value="Seinen">Seinen</option>
    </select>
    <select id="statusFilter">
        <option value="">Tous les statuts</option>
        <option value="En cours">En cours</option>
        <option value="Termin√©">Termin√©</option>
        <option value="En Pause">En Pause</option>
        <option value="Abandonn√©">Abandonn√©</option>
        <option value="Envie de voir">Envie de voir</option>
    </select>
</div>


    <style>
        /* Import de la police */
@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

/* üåå Style g√©n√©ral */
body {
    font-family: 'Poppins', sans-serif;
    background: radial-gradient(circle, rgba(25,34,77,1) 0%, rgba(0,0,0,1) 100%);
    overflow-x: hidden;
    margin: 0;
    padding: 0;
}

/* üñºÔ∏è Image de fond */
.image-wrapper {
  position: relative;
  max-height: 620px;
  overflow: hidden;
}

#berserkimage {
  width: 100%;
  height: auto;
  max-height: 620px;
  object-fit: cover;
  display: block;
}

.gradient-overlay {
  position: absolute;
  inset: 0;
  z-index: 10;
  pointer-events: none;
  background-image: linear-gradient(
    to top,
    rgb(31, 31, 10) calc(-510px + 50vw),
    rgba(25,34,77,1) 50%,
    transparent 100%
  );
  background-size: cover;
}


/* üß≠ Navigation */
ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: transparent;
}
li {
    float: left;
}
li a {
    display: block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}
li a:hover {
    background-color: red;
    border-radius: 10px;
}

/* üñ±Ô∏è Boutons */
.btn, .btn2 {
    position: absolute;
    background-color: red;
    color: white;
    font-size: 16px;
    padding: 16px 30px;
    border: none;
    cursor: pointer;
    border-radius: 10px;
    text-align: center;
}
.btn {
    top: 65%;
    left: 10%;
}
.btn2 {
    top: 1%;
    left: 90%;
}

/* üìù Titre principal */
.BigText {
    position: absolute;
    top: 30%;
    left: 10%;
    width: 30%;
    font-size: 300%;
    color: white;
}

/* üé¨ Section animes */


hr.rounded {
    border-top: 3px solid red;
    border-radius: 5px;
}

.movieimg h2,
.movieimg span,
.rating-stars {
    text-align: center;
}

.moviesection {
    max-width: 1300px;
    margin: 0 auto;
    padding: 0 20px;
    color: white;
    text-transform: uppercase;
}

.moviecontainer {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 30px;
    padding: 40px 20px;
    max-width: 1300px;
    margin: 0 auto;
    box-sizing: border-box;
    justify-content: center;
    justify-items: center;
    pointer-events: none !important; /* d√©sactive les hover sur les espaces vides */
}
.movieimg {
    width: 300px;
    text-align: center;
    color: white;
    position: relative;
    transition: transform 0.3s ease;
    transform: scale(1);
    pointer-events: auto !important; /* ‚Üê tr√®s important */
    will-change: transform;
}


.movieimg:hover {
  z-index: 1;
}

.movieimg:hover > .myimages {
  transform: scale(1.05);
  box-shadow: 0 0 20px red;
  border: 3px solid #0385fe;
}

.myimages {
  transition: transform 0.3s ease;
}


.movieimg .myimages {
    width: 100%;
    height: 450px;
    overflow: hidden;
    border-radius: 10px;
    background-color: #000;
    position: relative;
}

.movieimg .myimages img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 10px;
    display: block;
}



.movieimg:hover .myimages img {
  box-shadow: 0 0 20px red;
  border: 3px solid #0385fe;
}





/* üé® Menu contextuel */
.context-menu {
    display: none;
    position: absolute;
    background: #fff;
    border: 1px solid #ccc;
    z-index: 1000;
}
.context-menu-item {
    padding: 8px;
    cursor: pointer;
}
.context-menu-item:hover {
    background: #eee;
}

/* üé• Modale vid√©o */
.modal {
    display: none;
    position: fixed;
    z-index: 10;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
    padding-top: 60px;
}
.modal-content {
    background: radial-gradient(circle, rgba(34,7,54,1) 0%, rgba(77,0,172,1) 100%);
    margin: 5% auto;
    padding: 20px;
    width: 80%;
    text-align: center;
    color: white;
    border-radius: 10px;
}
.modal-content h1 {
    color: white;
}
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}
.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}
#videoPlayer {
    width: 640px;
    height: 360px;
    display: block;
    margin: 20px auto;
}
.controls {
    text-align: center;
}
select {
    width: 200px;
    height: 50px;
    font-size: 16px;
}

/* üß≠ Carrousel (si utilis√©) */
.wrapper {
    display: flex;
    grid-gap: 1em;
    overflow: hidden;
    width: 70em;
}
.wrapper .inner {
    display: flex;
    grid-gap: 1em;
    transition: all 1s ease-in-out;
    width: calc(17.5em * 12);
}
.card {
    border-radius: 0.5em;
    box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.5);
    background-color: navy;
    width: 17.5em;
    height: 25em;
    overflow: hidden;
}
.card img {
    border-top-right-radius: inherit;
    border-top-left-radius: inherit;
    display: block;
    width: 100%;
    height: 75%;
    object-fit: cover;
}
.card .content {
    background-color: darkblue;
    border-bottom-left-radius: inherit;
    border-bottom-right-radius: inherit;
    padding: 1em;
    text-align: center;
    height: 25%;
}
.card .content h1 {
    color: #fff;
    font-size: 1.25rem;
    margin: 0.35em 0;
}
.card .content h3 {
    color: #ccc;
    font-size: 0.9rem;
    font-weight: 300;
    margin: 0.35em 0;
}

.favorite-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 24px;
    color: gold;
    background: rgba(0, 0, 0, 0.6);
    border-radius: 50%;
    padding: 4px;
    display: none;
    z-index: 2;
}

.rating-stars {
    margin-top: 5px;
    font-size: 18px;
    color: gold;
    text-align: center;
}
@media screen and (max-width: 1000px) {
    #berserkimage {
        width: 100%;
    }
    ul {
        width: 100%;
    }
}

@media screen and (max-width: 600px) {
    .moviecontainer {
        grid-template-columns: 1fr;
        padding: 20px;
    }

    .movieimg {
        width: 100%;
        max-width: 300px;
    }

    .movieimg .myimages {
        height: auto;
        aspect-ratio: 2 / 3;
    }

    .movieimg .myimages img {
        height: 100%;
        width: 100%;
        object-fit: cover;
    }
}





    </style>
    <!-- Script principal -->
    <script src="script.js" defer></script>
    <script>
        // üéûÔ∏è Liste des √©pisodes
const episodes = [
    'https://video.sibnet.ru/shell.php?videoid=4906990&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4906993&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4906996&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907001&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907002&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907007&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907009&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907013&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907016&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907019&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907023&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907030&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907033&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907038&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907043&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907046&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907049&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907053&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907057&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907062&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907064&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907070&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907073&share=1',
    'https://video.sibnet.ru/shell.php?videoid=4907077&share=1'
];

let currentEpisode = 0;

function loadEpisode(index) {
  const video = document.getElementById('videoPlayer');
  video.src = episodes[index];
  document.getElementById('episodeTitle').innerText = '√âpisode ' + (parseInt(index) + 1);
  document.getElementById('episodeSelector').value = index;
  currentEpisode = parseInt(index);
  markEpisodeAsViewed(index); // ‚úÖ ici !
}


function nextEpisode() {
  if (currentEpisode < episodes.length - 1) {
    loadEpisode(currentEpisode + 1);
  }
}

function previousEpisode() {
  if (currentEpisode > 0) {
    loadEpisode(currentEpisode - 1);
  }
}

function generateOptions() {
  const selector = document.getElementById('episodeSelector');
  selector.innerHTML = '';
  for (let i = 0; i < episodes.length; i++) {
    const option = document.createElement('option');
    option.value = i;
    option.text = '√âpisode ' + (i + 1);
    selector.appendChild(option);
  }
}
function markEpisodeAsViewed(index) {
  let viewedEpisodes = JSON.parse(localStorage.getItem('viewedEpisodes')) || [];
  if (!viewedEpisodes.includes(index)) {
    viewedEpisodes.push(index);
    localStorage.setItem('viewedEpisodes', JSON.stringify(viewedEpisodes));
  }
  updateProgressBar();
}


function updateProgressBar() {
  const totalEpisodes = episodes.length;
  const viewedEpisodes = JSON.parse(localStorage.getItem('viewedEpisodes')) || [];
  const percentage = (viewedEpisodes.length / totalEpisodes) * 100;
  document.getElementById("progress-bar").style.width = percentage + '%';
}


function getRandomImage(images) {
    return images[Math.floor(Math.random() * images.length)];
}

function loadRandomPosters() {
    const posters = {
        erased: [
            "https://fr.web.img5.acsta.net/pictures/19/09/20/16/59/1993201.jpg",
            "https://ih1.redbubble.net/image.546580566.3272/flat,750x,075,f-pad,750x1000,f8f8f8.jpg",
            "https://m.media-amazon.com/images/I/71kAsfINhVL._AC_UF894,1000_QL80_.jpg"
        ],
        steinsgate: [
            "https://www.nautiljon.com/images/anime/00/76/steins_gate_1967.webp",
            "https://m.media-amazon.com/images/I/71qP5EqnxXS._AC_UF1000,1000_QL80_.jpg",
            "https://i.pinimg.com/originals/75/77/bd/7577bd0a1fbcbbb92c38c1293fd5e320.jpg"
        ],
        cotn: [
            "https://fr.web.img3.acsta.net/pictures/22/07/04/14/30/5500974.jpg",
            "https://m.media-amazon.com/images/M/MV5BMDNkM2QxNmUtYzMyZC00OWJlLTkwMmYtZDg4MzFjNjY5NGIzXkEyXkFqcGdeQXVyMzgxODM4NjM@._V1_FMjpg_UX1000_.jpg",
            "https://pbs.twimg.com/media/Fy15mftXgAc26oz.jpg"
        ],
        cyberpunk: [
            "https://fr.web.img4.acsta.net/pictures/22/06/09/09/16/1463272.jpg",
            "https://i.ebayimg.com/images/g/2ncAAOSwqu9jRL9d/s-l1200.jpg",
            "https://image.tmdb.org/t/p/original/7jSWOc6jWSw5hZ78HB8Hw3pJxuk.jpg"
        ],
        platinumend: [
            "https://fr.web.img2.acsta.net/pictures/21/08/02/11/23/3965735.jpg",
            "https://m.media-amazon.com/images/I/61TDQm0F7zL._AC_UF1000,1000_QL80_.jpg",
            "https://media-cache.cinematerial.com/p/500x/8qmq6xtn/platinum-end-japanese-movie-poster.jpg?v=1645981100"
        ],
        hellsparadise: [
            "https://fr.web.img2.acsta.net/pictures/23/03/22/17/10/3028192.jpg",
            "https://static.printler.com/cache/6/0/c/f/e/b/60cfeb4c9c1a3af0edf10997ec3d7a114c4611e6.jpg",
            "https://image.tmdb.org/t/p/original/1V9I7SvZbYoMbSvdtnlkkq9SB1k.jpg"
        ],
        chibirevengers: [
            "https://i.pinimg.com/736x/b1/85/f5/b185f504bbc6662801c4642f2d59d165.jpg",
            "https://static.zerochan.net/Tokyo.Revengers.full.3370247.jpg",
            "https://i0.wp.com/i.pinimg.com/originals/bf/df/3a/bfdf3a287ef6f55d3e7cbb0c8069a21e.jpg"
        ],
        deathnote: [
            "deathposterun.jpg",
            "deathposterdeux.jpg",
            "https://static.posters.cz/image/1300/affiches-et-posters/death-note-fate-connects-us-i206600.jpg"
        ],
        oshinoko: [
            "https://www.nautiljon.com/images/more/04/39/364593.webp",
            "https://fr.web.img3.acsta.net/r_1280_720/pictures/23/03/27/09/50/3692966.jpg",
            "posteroshi.jpeg"
        ],
        deathparade: [
            "https://fr.web.img6.acsta.net/pictures/19/07/10/15/27/4695755.jpg",
            "https://ih1.redbubble.net/image.1552907528.2553/flat,750x,075,f-pad,750x1000,f8f8f8.jpg",
            "https://i.ebayimg.com/images/g/si8AAOSwCA5bbB~F/s-l1200.jpg"
        ],
               blueperiod: [
            "https://res.cloudinary.com/jerrick/image/upload/d_642250b563292b35f27461a7.png,f_jpg,fl_progressive,q_auto,w_1024/6316d798154b25001eb94b4c.png",
            "https://m.media-amazon.com/images/I/61HUDQkhIyL._AC_UF1000,1000_QL80_.jpg",
            "https://m.media-amazon.com/images/I/71c2XKLkeLL._AC_UF894,1000_QL80_.jpg"
        ],
        steinsgate0: [
            "https://www.nautiljon.com/images/anime/00/98/steins_gate_0_4689.webp",
            "https://image.tmdb.org/t/p/original/jbRSUeWu6saPLrBEWei4CdLrAYX.jpg",
            "https://image.tmdb.org/t/p/original/oysiTMX6kMBCfG7iVRUgATcWiCp.jpg"
        ],
        jujutsukaisen: [
            "https://www.manga-news.com/public/images/dvd/Jujutsu-Kaisen-S2_anime.jpg",
            "https://static.posters.cz/image/750/affiches-et-posters/jujutsu-kaisen-jujutsushi-i195602.jpg",
            "https://m.media-amazon.com/images/I/71kBr22ahDL._AC_UF1000,1000_QL80_.jpg"
        ],
        dragonball: [
            "https://fr.web.img2.acsta.net/pictures/22/11/22/14/02/3642167.jpg",
            "https://m.media-amazon.com/images/I/712mWgOWX+L._AC_UF1000,1000_QL80_.jpg",
            "https://pbs.twimg.com/media/FfqAe8dagAE7fkJ.jpg"
        ]
    };

    for (const id in posters) {
        const img = document.getElementById(id);
        if (img) {
            img.src = getRandomImage(posters[id]);
        }
    }
}

// -------------------- FAVORIS --------------------
function toggleFavorite(title) {
  let animes = JSON.parse(localStorage.getItem('animes')) || [];
  const index = animes.findIndex(a => a.title === title);
  if (index !== -1) {
    animes[index].favorite = !animes[index].favorite;
  } else {
    animes.push({ title, favorite: true });
  }
  localStorage.setItem('animes', JSON.stringify(animes));
  renderFavorites();
}

function renderFavorites() {
  const animes = JSON.parse(localStorage.getItem('animes')) || [];
  document.querySelectorAll('.favorite-badge').forEach(badge => badge.style.display = 'none');
  animes.forEach(anime => {
    if (anime.favorite) {
      const badge = document.querySelector(`.movieimg[data-title="${anime.title}"] .favorite-badge`);
      if (badge) badge.style.display = 'inline';
    }
  });
}

function injectFavoriteBadges() {
  document.querySelectorAll('.movieimg').forEach(card => {
    if (!card.querySelector('.favorite-badge')) {
      const badge = document.createElement('span');
      badge.className = 'favorite-badge';
      badge.textContent = '‚≠ê';
      badge.style.display = 'none';
      card.appendChild(badge);
    }
  });
}

// -------------------- NOTES --------------------
function rateAnime(title, rating) {
  let animes = JSON.parse(localStorage.getItem('animes')) || [];
  const index = animes.findIndex(a => a.title === title);
  if (index !== -1) {
    animes[index].rating = rating;
  } else {
    animes.push({ title, rating });
  }
  localStorage.setItem('animes', JSON.stringify(animes));
  renderRatings();
}

function renderRatings() {
  const animes = JSON.parse(localStorage.getItem('animes')) || [];
  animes.forEach(anime => {
    const container = document.querySelector(`.movieimg[data-title="${anime.title}"] .rating-stars`);
    if (container && anime.rating) {
      container.innerHTML = '‚òÖ'.repeat(anime.rating) + '‚òÜ'.repeat(5 - anime.rating);
    }
  });
}

// -------------------- CONTEXT MENU --------------------
function setupContextMenu() {
  const menu = document.getElementById('context-menu');
  document.querySelectorAll('.movieimg').forEach(anime => {
    anime.addEventListener('contextmenu', function (e) {
      e.preventDefault();
      menu.style.display = 'block';
      menu.style.left = `${e.pageX}px`;
      menu.style.top = `${e.pageY}px`;
      menu.dataset.title = this.dataset.title;
      menu.dataset.genre = this.dataset.genre;
      menu.dataset.img = this.querySelector('img').src;
    });
  });

  document.querySelectorAll('.context-menu-item[data-status]').forEach(item => {
    item.addEventListener('click', function () {
      const animes = JSON.parse(localStorage.getItem('animes')) || [];
      const title = menu.dataset.title;
      const genre = menu.dataset.genre;
      const img = menu.dataset.img;
      const status = this.dataset.status;
      const index = animes.findIndex(a => a.title === title);
      if (index !== -1) {
        animes[index].status = status;
      } else {
        animes.push({ title, genre, img, status });
      }
      localStorage.setItem('animes', JSON.stringify(animes));
      applyFilters();
      menu.style.display = 'none';
    });
  });

  window.addEventListener('click', () => menu.style.display = 'none');
}

function handleFavorite() {
  const title = document.getElementById('context-menu').dataset.title;
  toggleFavorite(title);
}

function handleRating() {
  const title = document.getElementById('context-menu').dataset.title;
  const rating = parseInt(prompt(`Note pour "${title}" (1 √† 5 √©toiles) :`));
  if (rating >= 1 && rating <= 5) {
    rateAnime(title, rating);
  } else {
    alert("Note invalide.");
  }
  document.getElementById('context-menu').style.display = 'none';
}

// -------------------- FILTRES --------------------
function applyFilters() {
  const genre = document.getElementById('genreFilter').value;
  const status = document.getElementById('statusFilter').value;
  const animes = JSON.parse(localStorage.getItem('animes')) || [];

  document.querySelectorAll('.movieimg').forEach(card => {
    const title = card.dataset.title;
    const genreMatch = !genre || card.dataset.genre === genre;
    const animeData = animes.find(a => a.title === title);
    const statusMatch = !status || (animeData && animeData.status === status);
    card.style.display = genreMatch && statusMatch ? 'block' : 'none';
  });
}

function applySearchFilter() {
  const search = document.getElementById('searchInput').value.toLowerCase();
  document.querySelectorAll('.movieimg').forEach(card => {
    const title = card.dataset.title.toLowerCase();
    card.style.display = title.includes(search) ? 'block' : 'none';
  });
}

// -------------------- IMPORT / EXPORT --------------------
function exportAnimeData() {
  const data = localStorage.getItem('animes');
  const blob = new Blob([data], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'mes_animes.json';
  a.click();
  URL.revokeObjectURL(url);
}

function setupImport() {
  const input = document.getElementById('importFile');
  if (!input) return;
  input.addEventListener('change', function () {
    const file = this.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function (e) {
      try {
        const data = JSON.parse(e.target.result);
        localStorage.setItem('animes', JSON.stringify(data));
        alert("Import r√©ussi !");
        location.reload();
      } catch {
        alert("Fichier invalide.");
      }
    };
    reader.readAsText(file);
  });
}


document.getElementById('searchInput').addEventListener('input', applySearchFilter);





document.addEventListener("DOMContentLoaded", () => {
  injectFavoriteBadges();
  renderFavorites();
  renderRatings();
  setupContextMenu();
  setupImport();
  applyFilters();
  generateOptions();
  loadEpisode(0);
  updateProgressBar();
  loadRandomPosters();

  document.getElementById('genreFilter').addEventListener('change', applyFilters);
  document.getElementById('statusFilter').addEventListener('change', applyFilters);
  document.getElementById('searchInput').addEventListener('input', applySearchFilter);
});


    </script>
</body>
</html>
